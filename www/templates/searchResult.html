<ion-view title="Sökresultat" class="has-tabs-top" ng-controller="SearchResultController as result">
  <ion-nav-buttons side="right">
    <button menu-toggle="right" class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <div class="tabs-striped tabs-top tabs-light">
    <div class="tabs">
      <div class="tab-item" ng-click="openModal(1)">
        Kategorier
      </div>
      <div class="tab-item" ng-click="openModal(2)">
        Filtrera
      </div>
      <div class="tab-item" ng-click="popover.show($event)">
        Sortera
      </div>
    </div>
  </div>
  <ion-content padding="false" class="has-header has-subheader">
   <div ng-show="articles.length > 0">
  	<ul class="list">
  		<li ng-click="result.goto({{article.dabas.GTIN}})" ng-repeat="article in articles" ng-class="article.dabas.images[0].Lank ? 'item-avatar' : ''" class="item">
        <img ng-show="article.dabas.images[0].Lank" ng-src="{{article.dabas.images[0].Lank}}"/>
  			<h2>{{ article.dabas.name }}</h2>
        <p><strong>{{ article.dabas.producer }}</strong> {{ article.dabas.country }}</p>
  		</li>
  	</ul>
    <button ng-click="loadMore()" ng-hide="nextPageDisabledClass() === true" class="button button-full">
      Visa fler
    </button>
   </div>
    <div ng-show="loader === true">
      <i class="icon ion-loading-c"></i>
    </div>
    <p ng-show="noResult === true">Inga resultat. Vänligen försök igen.</p>
  </ion-content>

  <script id="categories.html" type="text/ng-template">
    <ion-modal-view>
      <ion-header-bar>
        <div class="button button-clear" ng-click="closeModal(1)">Avbryt</div>
        <h1 class="title">Kategorier</h1>
  	  <div class="button button-clear" ng-click="result.applyCategories()">Välj</div>
      </ion-header-bar>
      <ion-content>
        <div class="list">
        <ion-checkbox ng-repeat="item in categories | orderBy:'article'"
                      ng-model="item.checked" 
                      ng-checked="item.checked">
          {{ item.article }}
        </ion-checkbox>
        </div>
      </ion-content>
    </ion-modal-view>
  </script>

  <script id="filter.html" type="text/ng-template">
    <ion-modal-view>
      <ion-header-bar>
        <div class="button button-clear" ng-click="closeModal(2)">Avbryt</div>
        <h1 class="title">Filtrera</h1>
  	  <div class="button button-clear" ng-click="result.applyFilters()">Välj</div>
      </ion-header-bar>
      <ion-content>
        <ion-list>
        <ion-item class="item item-icon-right" ng-show="producers.length > 0" ng-click="accordionShow('producers')">
          Tillverkare
          <i class="icon" ng-class="(accordion.producers == 1) ? 'ion-chevron-up' : 'ion-chevron-down'"></i>
        </ion-item>
        <div class="accordion-content" ng-show="accordion.producers === 1">
         <div class="list">
          <ion-checkbox ng-repeat="item in producers | orderBy:'name'"
                        ng-model="item.checked" 
                        ng-checked="item.checked">
            {{ item.name }}
          </ion-checkbox>
          </div>
        </div>
        <ion-item class="item item-icon-right" ng-show="countries.length > 0" ng-click="accordionShow('countries')">
          Länder
          <i class="icon" ng-class="(accordion.countries == 1) ? 'ion-chevron-up' : 'ion-chevron-down'"></i>
        </ion-item>
        <div class="accordion-content" ng-show="accordion.countries === 1">
         <div class="list">
          <ion-checkbox ng-repeat="item in countries | orderBy:'name'"
                        ng-model="item.checked" 
                        ng-checked="item.checked">
            {{ item.name }}
          </ion-checkbox>
         </div>
        </div>
        </ion-list>
      </ion-content>
    </ion-modal-view>
  </script>

  <script id="templates/sort.html" type="text/ng-template">
    <ion-popover-view>
        <div class="list">
          <div class="item" ng-click="sort()">
            Namn
          </div>
          <div class="item" ng-click="sort()">
            Koldioxid
          </div>
          <div class="item" ng-click="sort()">
            Land
          </div>
          <div class="item" ng-click="sort()">
            Tillverkare
          </div>
        </div>
    </ion-popover-view>
  </script>
</ion-view>